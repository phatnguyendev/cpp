á» bÃ i trÆ°á»›c chÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu sÆ¡ qua VÃ²ng láº·p thÃ´ng Ä‘iá»‡p chÃ­nh vá»›i hÃ m GetMessage. HÃ´m nay, chÃºng ta sáº½ Ä‘i tÃ¬m hiá»ƒu ká»¹ hÆ¡n váº¥n Ä‘á» nÃ y.

## Váº¥n Ä‘á» Ä‘áº·t ra:
Khi game cá»§a chÃºng ta cÃ³ cÃ¡c Ä‘á»‘i tÆ°á»£ng di chuyá»ƒn trÃªn mÃ n hÃ¬nh nhÆ° náº¥m Ä‘á»™c, rÃ¹a, Ä‘áº¡n báº¯n, chÃ¡y ná»•...ta sáº½ cáº§n má»i thá»© chuyá»ƒn Ä‘á»™ng liÃªn tá»¥c cho dÃ¹ cÃ³ hay khÃ´ng cÃ³ thÃ´ng Ä‘iá»‡p nÃ o trong hÃ ng Ä‘á»£i. VÃ²ng láº·p thÃ´ng Ä‘iá»‡p á»Ÿ bÃ i trÆ°á»›c sáº½ khÃ´ng cÃ²n phÃ¹ há»£p vá»›i game vÃ¬ nÃ³ sáº½ dá»«ng láº¡i (khÃ´ng lÃ m gÃ¬ cáº£) ngay táº¡i hÃ m GetMessage khi khÃ´ng cÃ³ thÃ´ng Ä‘iá»‡p nÃ o (khi ngÆ°á»i dÃ¹ng khÃ´ng Ä‘á»¥ng tá»›i chuá»™t, bÃ n phÃ­m...). YÃªu cáº§u lÃºc nÃ y lÃ  pháº£i cÃ³ má»™t vÃ²ng láº·p cháº¡y liÃªn tá»¥c Ä‘áº£m báº£o:
- Giá»¯ má»i thá»© chuyá»ƒn Ä‘á»™ng.
- Äá»“ng thá»i pháº£i nháº­n vÃ  xá»­ lÃ½ thÃ´ng Ä‘iá»‡p trong hÃ ng Ä‘á»£i (náº¿u cÃ³).

**CÃ¡ch giáº£i quyáº¿t**: Sá»­ dá»¥ng hÃ m **PeekMessage** thay cho GetMessage.
## PeekMessage
PeekMessage sáº½ kiá»ƒm tra xem cÃ³ thÃ´ng Ä‘iá»‡p trong hÃ ng Ä‘á»£i hay khÃ´ng. Náº¿u cÃ³ thÃ¬ láº¥y thÃ´ng Ä‘iá»‡p ra y nhÆ° GetMessage. Náº¿u khÃ´ng cÃ³, thay vÃ¬ Ä‘á»©ng Ä‘á»£i nhÆ° GetMessage thÃ¬ PeekMessage sáº½ thoÃ¡t ra Ä‘á»ƒ má»i thá»© tiáº¿p tá»¥c cháº¡y.
Khai bÃ¡o:
{% highlight cpp %}
BOOL PeekMessage(
	LPMSG lpMsg, //con trá» Ä‘áº¿n nÆ¡i lÆ°u trá»¯ MSG
    HWND hWnd,
    UNIT wMsgFilterMin, //thÃ´ng Ä‘iá»‡p Ä‘áº§u tiÃªn
    UNIT wMsgFilterMax, //thÃ´ng Ä‘iá»‡p cuá»‘i cÃ¹ng
    UNIT wRemoveMsg);
{% endhighlight %}
Trong Ä‘Ã³:
- TÆ°Æ¡ng tá»± vá»›i GetMessage, hai tham sá»‘ **wMsgFilterMin** vÃ  **wMsgFilterMax** Ä‘Æ°á»£c gÃ¡n giÃ¡ trá»‹ báº±ng 0.
- **wRemoveMsg** nháº­n má»™t trong hai háº±ng sá»‘ PM_NOREMOVE vÃ  PM_REMOVE tÆ°Æ¡ng á»©ng vá»›i viá»‡c gá»¡ thÃ´ng Ä‘iá»‡p ra hÃ ng Ä‘á»£i hay khÃ´ng khi nÃ³ Ä‘Ã£ Ä‘á»c thÃ´ng Ä‘iá»‡p tá»« hÃ ng Ä‘á»£i vÃ o lpMsg.

Äoáº¡n code vá»›i PeekMessage sáº½ trÃ´ng nhÆ° sau:
{% highlight cpp %}
//khá»Ÿi táº¡o game
Game_Init();

//vÃ²ng láº·p thÃ´ng Ä‘iá»‡p chÃ­nh
while (!done)
{
	if(PeekMessage(&msg, NULL, 0, 0, PM_REMOVE))
    {
    	//kiá»ƒm tra xem cÃ³ pháº£i thÃ´ng Ä‘iá»‡p thoÃ¡t?
        if(msg.message == WM_QUIT)
        	done = 1;
        //Giáº£i mÃ£ vÃ  truyá»n thÃ´ng Ä‘iá»‡p cho WndProc
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }
    
    //process game loop
    Game_Run();
}
{% endhighlight %}
LÆ°u Ä‘á»“ Ã½ tÆ°á»Ÿng cá»§a PeekMessage:
![](https://1.bp.blogspot.com/-EZktX1_uIUU/XSqkMSBEkNI/AAAAAAAAECY/cmutgz3b0xQHJXw7rNXBkjZ9nFqAwrkgACLcBGAs/s1600/PeekMess.PNG)

## Tá»•ng káº¿t
ChÃºng ta Ä‘Ã£ cÃ¹ng nhau tÃ¬m hiá»ƒu vá» cáº¥u trÃºc cá»§a má»™t chÆ°Æ¡ng trÃ¬nh Windowsâ€¦CÃ¡c báº¡n hÃ£y luyá»‡n táº­p code láº¡i cÃ¡c vÃ­ dá»¥ trong bÃ i Ä‘á»ƒ náº¯m vÃ  hiá»ƒu rÃµ hÆ¡n vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nÃ³ nhÃ©, hÆ¡n tháº¿ cÃ¡c Ä‘oáº¡n code nÃ y vá» sau sáº½ sá»­ dá»¥ng ráº¥t nhiá»u Ä‘áº¿n lÃºc Ä‘Ã³ cÃ¡c báº¡n chá»‰ cáº§n coppy sá»­ dá»¥ng láº¡i thÃ´i.ğŸ˜‰ HÃ£y truy cáº­p vÃ o Series Make Game - TuiTuCode Ä‘á»ƒ há»c tiáº¿p nhá»¯ng bÃ i thÃº vá»‹ khÃ¡c ná»¯a. Náº¿u cÃ³ tháº¯c máº¯c cÃ¡c báº¡n cá»© bÃ¬nh luáº­n bÃªn dÆ°á»›i hoáº·c gá»­i tháº¯c máº¯c vá» page TuiTuCode Ä‘á»ƒ cÃ¡c ad giáº£i Ä‘Ã¡p. Pie~